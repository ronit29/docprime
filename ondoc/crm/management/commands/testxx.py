from django.core.management.base import BaseCommand

from ondoc.insurance.models import UserInsurance
from ondoc.account.models import MerchantPayout
from django.db import transaction

class Command(BaseCommand):

    help = 'Create payouts for appointments'

    #@transaction.atomic
    def handle(self, *args, **options):
        print('hello')
        #mps = MerchantPayout.objects.filter(id__in=[1020702,1020748,1020720,1020710,1020722,1020740,1020756,1020711,1020709,1020339,1020719,1020721,1020712,1020730,1020700,1020726,1020341,1020415,1020357,1020358,1020403,1020418,1020356,1020703,1020543,1020677,1020672,1020411,1020565,1020708,1020676,1020675,1020687,1020413,1020354,1020689,1020355,1020417,1020716,1020623,1020678,1020670,1020398,1020622,1020344,1020816,1020729,1020402,1020685,1020686,1020724,1020690,1020610,1020405,1020406,1020412,1020477,1020707,1020416,1020693,1020760,1017911,1020761,1020762,1020422,1020765,1020767,1020763,1020699,1020768,1020423,1020769,1020424,1020771,1020774,1020427,1020775,1020428,1020430,1020779,1020431,1020780,1020420,1020781,1020784,1020785,1020467,1020469,1020471,1020472,1020473,1020793,1020474,1020475,1020794,1020476,1020795,1020796,1020806,1020807,1019800,1019467,1019300,1019039,1020737,1017841,1020114,1019888,1019588,1019506,1019092,1018451,1017979,1017740,1020735,1020694,1020728,1020723,1018871])
        mps = MerchantPayout.objects.filter(id=1020621)
        for mp in mps:
            mp.update_status_from_pg()
        #UserInsurance.transfer_to_nodal_if_required()

        # uis = UserInsurance.objects.filter(id=3000000906, premium_transferred=False)
        # for ui in uis:
        #     print(str(ui.id))
        #     ui.process_payout()

        #     ui.process_payout()
        #3000000449
        #return
        #UserInsurance.all_premiums_which_need_transfer()
        # ui = UserInsurance.objects.filter(id__in=[3000001144,3000001145,3000001146,3000001147,3000001148,3000001149,3000001151,3000001153,3000001155,3000001157,3000001158,3000001114,3000001115,3000001116,3000001117,3000001119,3000001120,3000001121,3000001124,3000001126,3000001127,3000001128,3000001129,3000001130,3000001131,3000001132,3000001133,3000001134,3000001135,3000001136,3000001137,3000001138,3000001139,3000001141,3000001142,3000001143,3000001160,3000001161,3000001162])
        # for u in ui:
        #     print(str(u.id))
        #     u.process_payout()